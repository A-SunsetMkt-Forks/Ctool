import{u as M,i as A}from"./action-4599c846.js";import{ae as p,d as L,y as N,z as k,D as O,I as U,H as j,c as x,w as d,r as $,B as T,f as w,v as r,j as n,m as Y,A as F,k as q,s as C,l as R,n as G}from"./tool-65d7eee7.js";import{u as J,t as K,z as P,e as Q}from"./en_US-d5fa91d3.js";import"./modulepreload-polyfill-3cfb730f.js";var S=(t=>(t[t.error=0]="error",t[t.empty=1]="empty",t[t.normal=2]="normal",t[t.unix=3]="unix",t))(S||{}),V=(t=>(t.second="second",t.millisecond="millisecond",t.nanosecond="nanosecond",t))(V||{});const g={second:0,millisecond:3,nanosecond:9},W=(t,f,m="auto")=>{const{type:u,format:l}=X(t);m=m==="auto"?l:m;try{if(u===1)return{isValid:!1,second:"",millisecond:"",nanosecond:""};if(u===0)throw new Error($t("time_error_format"));let a,s;const c=g[m];if(u===2){const v=t.split(".");a=(v[1]||"").slice(0,c),s=p.tz(v[0],f)}else s=p(parseInt(c?t.slice(0,-1*c):t)*1e3).tz(f),a=c?t.slice(-1*c):"";if(!s.isValid())throw new Error($t("time_error_format"));const _=u===2?s.unix().toString():s.format("YYYY-MM-DD HH:mm:ss"),b=a.slice(0,g.millisecond).padEnd(g.millisecond,"0"),e=a.slice(0,g.nanosecond).padEnd(g.nanosecond,"0"),o=u===2?"":".";return{isValid:!0,second:_,millisecond:`${_}${o}${b}`,nanosecond:`${_}${o}${e}`,format:m,autoFormat:l,type:u}}catch(a){const s=$error(a);return{isValid:!1,second:s,millisecond:s,nanosecond:s,type:u,format:m,autoFormat:l}}},X=t=>t===""?{type:1,format:"second"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(t)?{type:2,format:"second"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d{0,3}$/).test(t)?{type:2,format:"millisecond"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d{4,9}$/).test(t)?{type:2,format:"nanosecond"}:new RegExp(/^-?\d{1,12}$/).test(t)?{type:3,format:"second"}:new RegExp(/^-?\d{13,16}$/).test(t)?{type:3,format:"millisecond"}:new RegExp(/^-?\d{17,}$/).test(t)?{type:3,format:"nanosecond"}:{type:0,format:"second"},oe=L({__name:"Timestamp",async setup(t){let f,m;p.extend(J),p.extend(K);const u="auto",l=M(([f,m]=N(()=>A({input:"",timezone:p.tz.guess(),format:u},{paste:e=>new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(e)||new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(e)||new RegExp(/^-?\d{5,}$/).test(e)})),f=await f,m(),f)),a=k(()=>W((l.current.input||"").trim(),l.current.timezone,l.current.format));O(()=>({data:l.current,is_valid:a.value.isValid,format:a.value.format}),({is_valid:e})=>{e&&l.save()},{immediate:!0,deep:!0});const s=k(()=>Object.entries($t("main_locale")==="zh_CN"?P:Q).map(([e,o])=>({value:e,label:`${o}`})));let c=U(p().valueOf());const _=setInterval(()=>{c.value=p().valueOf()},100);j(()=>{clearInterval(_)});const b=k(()=>{const e=p(c.value).tz(l.current.timezone);return[{format:$t("time_normal_second"),value:e.format("YYYY-MM-DD HH:mm:ss")},{format:$t("time_unix_second"),value:e.unix().toString()},{format:$t("time_normal_millisecond"),value:e.format("YYYY-MM-DD HH:mm:ss.SSS")},{format:$t("time_unix_millisecond"),value:e.valueOf().toString()}]});return(e,o)=>{const v=$("Select"),y=$("Input"),E=$("Button"),D=$("Align"),z=$("Display"),B=$("Link"),H=$("Table"),h=T("row");return w(),x(D,{direction:"vertical"},{default:d(()=>[r(v,{size:"large",width:"100%",center:!1,label:e.$t("time_timezone"),modelValue:n(l).current.timezone,"onUpdate:modelValue":o[0]||(o[0]=i=>n(l).current.timezone=i),options:n(s),onChange:o[1]||(o[1]=i=>n(l).current.timezone=i)},null,8,["label","modelValue","options"]),r(z,{position:"right-center"},{extra:d(()=>[r(D,null,{default:d(()=>[n(a).type===n(S).unix?(w(),x(v,{key:0,modelValue:n(l).current.format,"onUpdate:modelValue":o[3]||(o[3]=i=>n(l).current.format=i),size:"small",options:[{value:"auto",label:`${e.$t("time_unix_auto")}:${e.$t(`time_unix_${n(a).autoFormat}`)}`},{value:n(V).second,label:e.$t("time_unix_second")},{value:n(V).millisecond,label:e.$t("time_unix_millisecond")},{value:n(V).nanosecond,label:e.$t("time_unix_nanosecond")}]},null,8,["modelValue","options"])):Y("",!0),n(l).current.input!==""?(w(),x(E,{key:1,text:e.$t("main_ui_clear"),onClick:o[4]||(o[4]=i=>n(l).current.input=""),size:"small"},null,8,["text"])):Y("",!0)]),_:1})]),default:d(()=>[r(y,{size:"large",modelValue:n(l).current.input,"onUpdate:modelValue":o[2]||(o[2]=i=>n(l).current.input=i),label:e.$t("main_ui_input"),placeholder:e.$t("time_timestamp_input_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),r(z,{position:"right-center",text:n(a).isValid?e.$t("main_ui_copy"):"",onClick:o[5]||(o[5]=()=>e.$copy(n(a).second))},{default:d(()=>[r(y,{readonly:"",size:"large","model-value":n(a).second,label:e.$t("time_second")},null,8,["model-value","label"])]),_:1},8,["text"]),F((w(),q("div",null,[r(z,{position:"right-center",text:n(a).isValid?e.$t("main_ui_copy"):"",onClick:o[6]||(o[6]=()=>e.$copy(n(a).millisecond))},{default:d(()=>[r(y,{readonly:"",size:"large","model-value":n(a).millisecond,label:e.$t("time_millisecond")},null,8,["model-value","label"])]),_:1},8,["text"]),r(z,{position:"right-center",text:n(a).isValid?e.$t("main_ui_copy"):"",onClick:o[7]||(o[7]=()=>e.$copy(n(a).nanosecond))},{default:d(()=>[r(y,{readonly:"",size:"large","model-value":n(a).nanosecond,label:e.$t("time_nanosecond")},null,8,["model-value","label"])]),_:1},8,["text"])])),[[h,"1-1"]]),C("div",null,[r(H,{columns:[{title:e.$t("time_format"),key:"format"},{title:e.$t("time_value"),key:"value"}],lists:n(b),"action-width":100,border:""},{column:d(({row:i})=>[C("td",null,R(i.format),1),C("td",null,[r(B,{onClick:Z=>e.$copy(i.value)},{default:d(()=>[G(R(i.value),1)]),_:2},1032,["onClick"])])]),default:d(({row:i})=>[r(E,{text:e.$t("main_ui_load"),onClick:()=>n(l).current.input=`${i.value}`,size:"small"},null,8,["text","onClick"])]),_:1},8,["columns","lists"])])]),_:1})}}});export{oe as default};
