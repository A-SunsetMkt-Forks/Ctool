import{u as h,i as M}from"./action-17347194.js";import{ae as c,d as A,y as L,z as b,D as N,I as O,H as U,r as $,A as j,c as k,w as d,f as w,v as r,j as i,m as D,B as T,k as F,s as x,l as Y,n as q}from"./tool-e3194735.js";import{u as G,t as J,z as K,e as P}from"./en_US-37fb4a40.js";import"./modulepreload-polyfill-3cfb730f.js";var R=(t=>(t[t.error=0]="error",t[t.empty=1]="empty",t[t.normal=2]="normal",t[t.unix=3]="unix",t))(R||{}),V=(t=>(t.second="second",t.millisecond="millisecond",t.nanosecond="nanosecond",t))(V||{});const y={second:0,millisecond:3,nanosecond:9},Q=(t,p,m="auto")=>{const{type:n,format:l}=W(t);m=m==="auto"?l:m;try{if(n===1)return{isValid:!1,second:"",millisecond:"",nanosecond:""};if(n===0)throw new Error($t("time_error_format"));let u,s;const f=y[m];if(n===2){const v=t.split(".");u=(v[1]||"").slice(0,f),s=c.tz(v[0],p)}else s=c(parseInt(f?t.slice(0,-1*f):t)*1e3).tz(p),u=f?t.slice(-1*f):"";if(!s.isValid())throw new Error($t("time_error_format"));const _=n===2?s.unix().toString():s.format("YYYY-MM-DD HH:mm:ss"),e=u.slice(0,y.millisecond).padEnd(y.millisecond,"0"),o=u.slice(0,y.nanosecond).padEnd(y.nanosecond,"0"),g=n===2?"":".";return{isValid:!0,second:_,millisecond:`${_}${g}${e}`,nanosecond:`${_}${g}${o}`,format:m,autoFormat:l,type:n}}catch(u){const s=$error(u);return{isValid:!1,second:s,millisecond:s,nanosecond:s,type:n,format:m,autoFormat:l}}},W=t=>t===""?{type:1,format:"second"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(t)?{type:2,format:"second"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d{0,3}$/).test(t)?{type:2,format:"millisecond"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d{4,9}$/).test(t)?{type:2,format:"nanosecond"}:new RegExp(/^-?\d{1,12}$/).test(t)?{type:3,format:"second"}:new RegExp(/^-?\d{13,16}$/).test(t)?{type:3,format:"millisecond"}:new RegExp(/^-?\d{17,}$/).test(t)?{type:3,format:"nanosecond"}:{type:0,format:"second"},X="auto",oe=A({__name:"Timestamp",async setup(t){let p,m;c.extend(G),c.extend(J);const n=h(([p,m]=L(()=>M({input:"",timezone:c.tz.guess(),format:X},{paste:e=>new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(e)||new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(e)||new RegExp(/^-?\d{5,}$/).test(e)})),p=await p,m(),p)),l=b(()=>Q((n.current.input||"").trim(),n.current.timezone,n.current.format));N(()=>({data:n.current,is_valid:l.value.isValid,format:l.value.format}),({is_valid:e})=>{e&&n.save()},{immediate:!0,deep:!0});const u=b(()=>Object.entries($t("main_locale")==="zh_CN"?K:P).map(([e,o])=>({value:e,label:`${o}`}))||[]);let s=O(c().valueOf());const f=setInterval(()=>{s.value=c().valueOf()},100);U(()=>{clearInterval(f)});const _=b(()=>{const e=c(s.value).tz(n.current.timezone);return[{format:$t("time_normal_second"),value:e.format("YYYY-MM-DD HH:mm:ss")},{format:$t("time_unix_second"),value:e.unix().toString()},{format:$t("time_normal_millisecond"),value:e.format("YYYY-MM-DD HH:mm:ss.SSS")},{format:$t("time_unix_millisecond"),value:e.valueOf().toString()}]});return(e,o)=>{const g=$("Select"),v=$("Input"),C=$("Button"),E=$("Align"),z=$("Display"),S=$("Link"),B=$("Table"),H=j("row");return w(),k(E,{direction:"vertical"},{default:d(()=>[r(g,{size:"large",width:"100%",center:!1,label:e.$t("time_timezone"),modelValue:i(n).current.timezone,"onUpdate:modelValue":o[0]||(o[0]=a=>i(n).current.timezone=a),options:u.value,onChange:o[1]||(o[1]=a=>i(n).current.timezone=a)},null,8,["label","modelValue","options"]),r(z,{position:"right-center"},{extra:d(()=>[r(E,null,{default:d(()=>[l.value.type===i(R).unix?(w(),k(g,{key:0,modelValue:i(n).current.format,"onUpdate:modelValue":o[3]||(o[3]=a=>i(n).current.format=a),size:"small",options:[{value:"auto",label:`${e.$t("time_unix_auto")}:${e.$t(`time_unix_${l.value.autoFormat}`)}`},{value:i(V).second,label:e.$t("time_unix_second")},{value:i(V).millisecond,label:e.$t("time_unix_millisecond")},{value:i(V).nanosecond,label:e.$t("time_unix_nanosecond")}]},null,8,["modelValue","options"])):D("",!0),i(n).current.input!==""?(w(),k(C,{key:1,text:e.$t("main_ui_clear"),onClick:o[4]||(o[4]=a=>i(n).current.input=""),size:"small"},null,8,["text"])):D("",!0)]),_:1})]),default:d(()=>[r(v,{size:"large",modelValue:i(n).current.input,"onUpdate:modelValue":o[2]||(o[2]=a=>i(n).current.input=a),label:e.$t("main_ui_input"),placeholder:e.$t("time_timestamp_input_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),r(z,{position:"right-center",text:l.value.isValid?e.$t("main_ui_copy"):"",onClick:o[5]||(o[5]=()=>e.$copy(l.value.second))},{default:d(()=>[r(v,{readonly:"",size:"large","model-value":l.value.second,label:e.$t("time_second")},null,8,["model-value","label"])]),_:1},8,["text"]),T((w(),F("div",null,[r(z,{position:"right-center",text:l.value.isValid?e.$t("main_ui_copy"):"",onClick:o[6]||(o[6]=()=>e.$copy(l.value.millisecond))},{default:d(()=>[r(v,{readonly:"",size:"large","model-value":l.value.millisecond,label:e.$t("time_millisecond")},null,8,["model-value","label"])]),_:1},8,["text"]),r(z,{position:"right-center",text:l.value.isValid?e.$t("main_ui_copy"):"",onClick:o[7]||(o[7]=()=>e.$copy(l.value.nanosecond))},{default:d(()=>[r(v,{readonly:"",size:"large","model-value":l.value.nanosecond,label:e.$t("time_nanosecond")},null,8,["model-value","label"])]),_:1},8,["text"])])),[[H,"1-1"]]),x("div",null,[r(B,{columns:[{title:e.$t("time_format"),key:"format"},{title:e.$t("time_value"),key:"value"}],lists:_.value,"action-width":100,border:""},{column:d(({row:a})=>[x("td",null,Y(a.format),1),x("td",null,[r(S,{onClick:Z=>e.$copy(a.value)},{default:d(()=>[q(Y(a.value),1)]),_:2},1032,["onClick"])])]),default:d(({row:a})=>[r(C,{text:e.$t("main_ui_load"),onClick:()=>i(n).current.input=`${a.value}`,size:"small"},null,8,["text","onClick"])]),_:1},8,["columns","lists"])])]),_:1})}}});export{oe as default};
