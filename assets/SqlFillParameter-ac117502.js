import{u as q,i as b}from"./action-6d7b183c.js";import{D as w,bj as x,l as y,bf as I,n as P,bk as f,aG as d,aH as T,at as g,y as m,bm as A,p as O,b0 as c}from"./history-22e01718.js";import"./shim-03580cdb.js";import"./_commonjsHelpers-87174ba5.js";const C=w({__name:"SqlFillParameter",async setup($){let u,h;const p=["String","Integer","Long","Timestamp"],n=q(([u,h]=x(()=>b({input:"",params:""})),u=await u,h(),u)),S=e=>e?e.split(",",-1).map(t=>{let s=t.lastIndexOf("(");if(s<0)throw new Error($t("sqlFillParameter_invalid_param",[t]));let a=t.substring(0,s);a=a.trim();let o=t.lastIndexOf(")");o<0&&(o=t.length);let l=t.substring(s+1,o);return l=l.trim(),{value:a,type:l}}):[],_=()=>{if(!n.current.input||!n.current.params)return"";let e=S(n.current.params),i=n.current.input,t="",s=0,a="";for(let o=0;o<i.length;o++){let l=i.charAt(o);if(l==="?"){if(e.length<=s)throw new Error($t("sqlFillParameter_parameter_too_little"));let r=e[s];switch(r.type){case p[0]:a=" '"+r.value+"'";break;case p[1]:case p[2]:a=r.value;break;case p[3]:a="Timestamp '"+r.value+"'";break;default:a=r.value}t+=a,s++}else t+=l}return t},v=()=>{let e=n.current.input;if(e){let i,t,s="Preparing:",a=e.indexOf(s);if(a>=0){let r=e.indexOf(`
`,a);r<0&&(r=e.length),i=e.substring(a+s.length,r)}let o="Parameters:",l=e.indexOf(o);if(l>=0){let r=e.indexOf(`
`,l);r<0&&(r=e.length),t=e.substring(l+o.length,r)}n.current.input=i,n.current.params=t}},E=y(()=>{try{let e=_();return n.save(),e}catch(e){return $error(e)}});return I(()=>({input:n.current.input,params:n.current.params}),({input:e,params:i})=>{i===""&&e!==""&&v()},{immediate:!0}),(e,i)=>{const t=d("Textarea"),s=d("Align"),a=d("HeightResize"),o=T("row");return g(),P(a,{ignore:"",reduce:5},{default:f(({height:l})=>[m(s,{direction:"vertical"},{default:f(()=>[A((g(),O("div",null,[m(t,{modelValue:c(n).current.input,"onUpdate:modelValue":i[0]||(i[0]=r=>c(n).current.input=r),height:l/2,placeholder:"Sql:SELECT * FROM T WHERE id=? AND name = ?",copy:"Sql"},null,8,["modelValue","height"]),m(t,{modelValue:c(n).current.params,"onUpdate:modelValue":i[1]||(i[1]=r=>c(n).current.params=r),height:l/2,placeholder:`${e.$t("sqlFillParameter_parameter")}:1(Integer),zhangshan(String)`,copy:e.$t("sqlFillParameter_parameter")},null,8,["modelValue","height","placeholder","copy"])])),[[o,"1-1"]]),m(t,{"model-value":E.value,copy:"",height:l/2,placeholder:`${e.$t("main_ui_output")}:SELECT * FROM T WHERE id=1 AND name='zhangshan'`},null,8,["model-value","height","placeholder"])]),_:2},1024)]),_:1})}}});export{C as default};
