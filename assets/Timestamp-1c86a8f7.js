import{u as B,i as R}from"./action-28c0dc22.js";import{D as j,bU as a,bj as U,l as s,bf as h,aB as N,ar as A,n as y,bk as m,aG as d,aH as L,at as f,y as i,b0 as o,o as C,bm as q,p as G,q as g,aU as S,x as Z}from"./history-72bd6fb6.js";import{u as F,t as J,z as K,e as P}from"./en_US-e946fe52.js";import"./shim-03580cdb.js";import"./_commonjsHelpers-87174ba5.js";const ae=j({__name:"Timestamp",async setup(Q){let v,b;a.extend(F),a.extend(J);const t=B(([v,b]=U(()=>R({input:"",timezone:a.tz.guess(),unix_type:2},{paste:e=>new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(e)||new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(e)||new RegExp(/^\d{5,}$/).test(e)})),v=await v,b(),v)),u=s(()=>(t.current.input||"").trim()),p=s(()=>u.value===""?!1:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(u.value)?0:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(u.value)?1:new RegExp(/^\d+$/).test(u.value)?2:!1),x=s(()=>new RegExp(/^\d{1,12}$/).test(u.value)?3:4),r=s(()=>{try{if(u.value==="")return"";if(p.value===!1)throw new Error($t("time_error_format"));let e;if(p.value===0?e=a.tz(u.value,t.current.timezone):p.value===1?e=a.tz(u.value,t.current.timezone):(t.current.unix_type===2?x.value:t.current.unix_type)===3?e=a(parseInt(u.value)*1e3).tz(t.current.timezone):e=a(parseInt(u.value)).tz(t.current.timezone),!e.isValid())throw new Error($t("time_error_format"));return e}catch(e){return $error(e)}}),_=s(()=>a.isDayjs(r.value)),w=s(()=>a.isDayjs(r.value)?p.value!==2?r.value.unix().toString():r.value.format("YYYY-MM-DD HH:mm:ss"):r.value),k=s(()=>a.isDayjs(r.value)?p.value!==2?r.value.valueOf().toString():r.value.format("YYYY-MM-DD HH:mm:ss.SSS"):r.value);h(()=>({data:t.current,is_valid:_.value}),({is_valid:e})=>{e&&t.save()},{immediate:!0,deep:!0});const T=s(()=>{const e=Intl.supportedValuesOf("timeZone");return Object.entries($t("main_locale")==="zh_CN"?K:P).filter(([n])=>e.includes(n)).map(([n,c])=>({value:n,label:`${c}`}))});let D=N(a().valueOf());const E=setInterval(()=>{D.value=a().valueOf()},100);A(()=>{clearInterval(E)});const H=s(()=>{const e=a(D.value).tz(t.current.timezone);return[{format:$t("time_normal_second"),value:e.format("YYYY-MM-DD HH:mm:ss")},{format:$t("time_unix_second"),value:e.unix().toString()},{format:$t("time_normal_millisecond"),value:e.format("YYYY-MM-DD HH:mm:ss.SSS")},{format:$t("time_unix_millisecond"),value:e.valueOf().toString()}]});return(e,n)=>{const c=d("Select"),$=d("Input"),V=d("Button"),Y=d("Align"),z=d("Display"),I=d("Link"),M=d("Table"),O=L("row");return f(),y(Y,{direction:"vertical"},{default:m(()=>[i(c,{size:"large",width:"100%",center:!1,label:e.$t("time_timezone"),modelValue:o(t).current.timezone,"onUpdate:modelValue":n[0]||(n[0]=l=>o(t).current.timezone=l),options:T.value,onChange:n[1]||(n[1]=l=>o(t).current.timezone=l)},null,8,["label","modelValue","options"]),i(z,{position:"right-center"},{extra:m(()=>[i(Y,null,{default:m(()=>[p.value===2?(f(),y(c,{key:0,modelValue:o(t).current.unix_type,"onUpdate:modelValue":n[3]||(n[3]=l=>o(t).current.unix_type=l),size:"small",options:[{value:2,label:`${e.$t("time_unix_auto")}:${x.value===3?e.$t("time_second"):e.$t("time_millisecond")}`},{value:3,label:e.$t("time_unix_second")},{value:4,label:e.$t("time_unix_millisecond")}]},null,8,["modelValue","options"])):C("",!0),o(t).current.input!==""?(f(),y(V,{key:1,text:e.$t("main_ui_clear"),onClick:n[4]||(n[4]=l=>o(t).current.input=""),size:"small"},null,8,["text"])):C("",!0)]),_:1})]),default:m(()=>[i($,{size:"large",modelValue:o(t).current.input,"onUpdate:modelValue":n[2]||(n[2]=l=>o(t).current.input=l),label:e.$t("main_ui_input"),placeholder:e.$t("time_timestamp_input_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),q((f(),G("div",null,[i(z,{position:"right-center",text:_.value?e.$t("main_ui_copy"):"",onClick:n[5]||(n[5]=()=>e.$copy(w.value))},{default:m(()=>[i($,{size:"large","model-value":w.value,label:e.$t("time_second")},null,8,["model-value","label"])]),_:1},8,["text"]),i(z,{position:"right-center",text:_.value?e.$t("main_ui_copy"):"",onClick:n[6]||(n[6]=()=>e.$copy(k.value))},{default:m(()=>[i($,{size:"large","model-value":k.value,label:e.$t("time_millisecond")},null,8,["model-value","label"])]),_:1},8,["text"])])),[[O,"1-1"]]),g("div",null,[i(M,{columns:[{title:e.$t("time_format"),key:"format"},{title:e.$t("time_value"),key:"value"}],lists:H.value,"action-width":100,border:""},{column:m(({row:l})=>[g("td",null,S(l.format),1),g("td",null,[i(I,{onClick:W=>e.$copy(l.value)},{default:m(()=>[Z(S(l.value),1)]),_:2},1032,["onClick"])])]),default:m(({row:l})=>[i(V,{text:e.$t("main_ui_load"),onClick:()=>o(t).current.input=`${l.value}`,size:"small"},null,8,["text","onClick"])]),_:1},8,["columns","lists"])])]),_:1})}}});export{ae as default};
