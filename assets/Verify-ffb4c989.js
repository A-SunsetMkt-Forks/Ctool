import{u as T,i as $}from"./action-c0645e21.js";import{c as f,a as D,T as s}from"./index-5818e2f6.js";import{s as w}from"./index-636623a5.js";import{A,bi as I,k as C,m as E,bj as a,aF as l,aG as U,as as g,x as n,bl as H,o as S,a$ as r}from"./history-cad96479.js";import"./_commonjsHelpers-87174ba5.js";import"./index-69be48ff.js";const J=A({__name:"Verify",async setup(z){let i,c;const e=T(([i,c]=I(()=>$({sourceData:f("text"),signValue:f("hex"),option:{public_key:"",user_id:"1234567812345678"},output:D("text")})),i=await i,c(),i)),V=C(()=>{if(e.current.sourceData.text.isEmpty()||e.current.signValue.text.isEmpty()||e.current.option.public_key==="")return s.empty();if(e.current.sourceData.text.isError())return e.current.sourceData.text;if(e.current.signValue.text.isError())return e.current.signValue.text;try{return w.sm2.doVerifySignature(e.current.sourceData.text.toUint8Array(),e.current.signValue.text.toHexString(),e.current.option.public_key,{hash:!0,userId:e.current.option.user_id})?s.fromString($t("sign_verify_ok")):s.fromString($t("sign_verify_fail"))}catch(u){return s.fromError($error(u))}});return(u,t)=>{const m=l("TextInput"),d=l("Input"),p=l("Align"),x=l("HelpTip"),y=l("Card"),h=l("TextOutput"),b=l("HeightResize"),v=U("row");return g(),E(b,{ignore:"",append:[".ctool-page-option"],reduce:10},{default:a(({small:k,large:_})=>[n(p,{direction:"vertical"},{default:a(()=>[H((g(),S("div",null,[n(m,{modelValue:r(e).current.sourceData,"onUpdate:modelValue":t[0]||(t[0]=o=>r(e).current.sourceData=o),height:_,placeholder:u.$t("sm2_source_data"),upload:"file"},null,8,["modelValue","height","placeholder"]),n(m,{modelValue:r(e).current.signValue,"onUpdate:modelValue":t[1]||(t[1]=o=>r(e).current.signValue=o),height:_,placeholder:u.$t("sm2_sign_value"),allow:["hex","base64"]},null,8,["modelValue","height","placeholder"])])),[[v,"1-1"]]),n(y,{title:u.$t("main_ui_config"),class:"ctool-page-option"},{extra:a(()=>[n(p,null,{default:a(()=>[n(x,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})]),default:a(()=>[n(p,{horizontal:"center"},{default:a(()=>[n(d,{modelValue:r(e).current.option.public_key,"onUpdate:modelValue":t[2]||(t[2]=o=>r(e).current.option.public_key=o),label:u.$t("sm2_public_key")},null,8,["modelValue","label"]),n(d,{modelValue:r(e).current.option.user_id,"onUpdate:modelValue":t[3]||(t[3]=o=>r(e).current.option.user_id=o),label:u.$t("sm2_userId")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["title"]),n(h,{modelValue:r(e).current.output,"onUpdate:modelValue":t[4]||(t[4]=o=>r(e).current.output=o),allow:["hex"],content:V.value,height:k,onSuccess:t[5]||(t[5]=o=>r(e).save())},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1},8,["append"])}}});export{J as default};
