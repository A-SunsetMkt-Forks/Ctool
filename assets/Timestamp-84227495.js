import{u as B,i as R}from"./action-b0774d39.js";import{d as h,ae as u,y as A,z as s,D as N,I as U,H as L,c as y,w as m,r as d,B as Z,f,v as a,j as n,m as S,A as q,k as F,s as g,l as T,n as G,aY as x}from"./tool-86fca7a1.js";import{u as J,t as K,z as P,e as Q}from"./en_US-f29fb547.js";import"./modulepreload-polyfill-3cfb730f.js";const ie=h({__name:"Timestamp",async setup(W){let c,w;u.extend(J),u.extend(K);const t=B(([c,w]=A(()=>R({input:"",timezone:u.tz.guess(),unix_type:2},{paste:e=>new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(e)||new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(e)||new RegExp(/^-?\d{5,}$/).test(e)})),c=await c,w(),c)),o=s(()=>(t.current.input||"").trim()),p=s(()=>o.value===""?!1:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(o.value)?0:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(o.value)?1:new RegExp(/^-?\d+$/).test(o.value)?2:!1),k=s(()=>new RegExp(/^-?\d{1,12}$/).test(o.value)?3:4),r=s(()=>{try{if(o.value==="")return"";if(p.value===!1)throw new Error($t("time_error_format"));let e;if(p.value===0?e=u.tz(o.value,t.current.timezone):p.value===1?e=u.tz(o.value,t.current.timezone):(t.current.unix_type===2?k.value:t.current.unix_type)===3?e=u(parseInt(o.value)*1e3).tz(t.current.timezone):e=u(parseInt(o.value)).tz(t.current.timezone),!e.isValid())throw new Error($t("time_error_format"));return e}catch(e){return $error(e)}}),_=s(()=>x.isDayjs(r.value)),D=s(()=>x.isDayjs(r.value)?p.value!==2?r.value.unix().toString():r.value.format("YYYY-MM-DD HH:mm:ss"):r.value),Y=s(()=>x.isDayjs(r.value)?p.value!==2?r.value.valueOf().toString():r.value.format("YYYY-MM-DD HH:mm:ss.SSS"):r.value);N(()=>({data:t.current,is_valid:_.value}),({is_valid:e})=>{e&&t.save()},{immediate:!0,deep:!0});const E=s(()=>{const e=Intl.supportedValuesOf("timeZone");return Object.entries($t("main_locale")==="zh_CN"?P:Q).filter(([l])=>e.includes(l)).map(([l,v])=>({value:l,label:`${v}`}))});let b=U(u().valueOf());const H=setInterval(()=>{b.value=u().valueOf()},100);L(()=>{clearInterval(H)});const I=s(()=>{const e=u(b.value).tz(t.current.timezone);return[{format:$t("time_normal_second"),value:e.format("YYYY-MM-DD HH:mm:ss")},{format:$t("time_unix_second"),value:e.unix().toString()},{format:$t("time_normal_millisecond"),value:e.format("YYYY-MM-DD HH:mm:ss.SSS")},{format:$t("time_unix_millisecond"),value:e.valueOf().toString()}]});return(e,l)=>{const v=d("Select"),$=d("Input"),V=d("Button"),C=d("Align"),z=d("Display"),M=d("Link"),O=d("Table"),j=Z("row");return f(),y(C,{direction:"vertical"},{default:m(()=>[a(v,{size:"large",width:"100%",center:!1,label:e.$t("time_timezone"),modelValue:n(t).current.timezone,"onUpdate:modelValue":l[0]||(l[0]=i=>n(t).current.timezone=i),options:n(E),onChange:l[1]||(l[1]=i=>n(t).current.timezone=i)},null,8,["label","modelValue","options"]),a(z,{position:"right-center"},{extra:m(()=>[a(C,null,{default:m(()=>[n(p)===2?(f(),y(v,{key:0,modelValue:n(t).current.unix_type,"onUpdate:modelValue":l[3]||(l[3]=i=>n(t).current.unix_type=i),size:"small",options:[{value:2,label:`${e.$t("time_unix_auto")}:${n(k)===3?e.$t("time_second"):e.$t("time_millisecond")}`},{value:3,label:e.$t("time_unix_second")},{value:4,label:e.$t("time_unix_millisecond")}]},null,8,["modelValue","options"])):S("",!0),n(t).current.input!==""?(f(),y(V,{key:1,text:e.$t("main_ui_clear"),onClick:l[4]||(l[4]=i=>n(t).current.input=""),size:"small"},null,8,["text"])):S("",!0)]),_:1})]),default:m(()=>[a($,{size:"large",modelValue:n(t).current.input,"onUpdate:modelValue":l[2]||(l[2]=i=>n(t).current.input=i),label:e.$t("main_ui_input"),placeholder:e.$t("time_timestamp_input_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),q((f(),F("div",null,[a(z,{position:"right-center",text:n(_)?e.$t("main_ui_copy"):"",onClick:l[5]||(l[5]=()=>e.$copy(n(D)))},{default:m(()=>[a($,{size:"large","model-value":n(D),label:e.$t("time_second")},null,8,["model-value","label"])]),_:1},8,["text"]),a(z,{position:"right-center",text:n(_)?e.$t("main_ui_copy"):"",onClick:l[6]||(l[6]=()=>e.$copy(n(Y)))},{default:m(()=>[a($,{size:"large","model-value":n(Y),label:e.$t("time_millisecond")},null,8,["model-value","label"])]),_:1},8,["text"])])),[[j,"1-1"]]),g("div",null,[a(O,{columns:[{title:e.$t("time_format"),key:"format"},{title:e.$t("time_value"),key:"value"}],lists:n(I),"action-width":100,border:""},{column:m(({row:i})=>[g("td",null,T(i.format),1),g("td",null,[a(M,{onClick:X=>e.$copy(i.value)},{default:m(()=>[G(T(i.value),1)]),_:2},1032,["onClick"])])]),default:m(({row:i})=>[a(V,{text:e.$t("main_ui_load"),onClick:()=>n(t).current.input=`${i.value}`,size:"small"},null,8,["text","onClick"])]),_:1},8,["columns","lists"])])]),_:1})}}});export{ie as default};
