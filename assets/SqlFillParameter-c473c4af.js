import{u as q,i as b}from"./action-a96f1524.js";import{D as w,bj as x,l as y,n as I,bk as h,aG as d,aH as P,at as g,y as m,bm as T,p as A,b0 as c}from"./history-032965eb.js";import"./shim-03580cdb.js";import"./_commonjsHelpers-87174ba5.js";const V=w({__name:"SqlFillParameter",async setup(O){let u,f;const p=["String","Integer","Long","Timestamp"],a=q(([u,f]=x(()=>b({input:"",params:""},{paste:!1})),u=await u,f(),u)),S=e=>e?e.split(",",-1).map(t=>{let i=t.lastIndexOf("(");if(i<0)throw new Error($t("sqlFillParameter_invalid_param",[t]));let n=t.substring(0,i);n=n.trim();let s=t.lastIndexOf(")");s<0&&(s=t.length);let l=t.substring(i+1,s);return l=l.trim(),{value:n,type:l}}):[],_=()=>{if(!a.current.input||!a.current.params)return"";let e=S(a.current.params),o=a.current.input,t="",i=0,n="";for(let s=0;s<o.length;s++){let l=o.charAt(s);if(l==="?"){if(e.length<=i)throw new Error($t("sqlFillParameter_parameter_too_little"));let r=e[i];switch(r.type){case p[0]:n=" '"+r.value+"'";break;case p[1]:case p[2]:n=r.value;break;case p[3]:n="Timestamp '"+r.value+"'";break;default:n=r.value}t+=n,i++}else t+=l}return t},v=()=>{let e=a.current.input;if(e){let o,t,i="Preparing:",n=e.indexOf(i);if(n>=0){let r=e.indexOf(`
`,n);r<0&&(r=e.length),o=e.substring(n+i.length,r)}let s="Parameters:",l=e.indexOf(s);if(l>=0){let r=e.indexOf(`
`,l);r<0&&(r=e.length),t=e.substring(l+s.length,r)}a.current.input=o,a.current.params=t}},E=y(()=>{try{(!a.current.input||!a.current.params)&&a.current.input&&v();let e=_();return a.save(),e}catch(e){return $error(e)}});return(e,o)=>{const t=d("Textarea"),i=d("Align"),n=d("HeightResize"),s=P("row");return g(),I(n,{ignore:"",reduce:5},{default:h(({height:l})=>[m(i,{direction:"vertical"},{default:h(()=>[T((g(),A("div",null,[m(t,{modelValue:c(a).current.input,"onUpdate:modelValue":o[0]||(o[0]=r=>c(a).current.input=r),height:l/2,placeholder:"Sql:SELECT * FROM T WHERE id=? AND name = ?",copy:"Sql"},null,8,["modelValue","height"]),m(t,{modelValue:c(a).current.params,"onUpdate:modelValue":o[1]||(o[1]=r=>c(a).current.params=r),height:l/2,placeholder:`${e.$t("sqlFillParameter_parameter")}:1(Integer),zhangshan(String)`,copy:e.$t("sqlFillParameter_parameter")},null,8,["modelValue","height","placeholder","copy"])])),[[s,"1-1"]]),m(t,{"model-value":E.value,copy:"",height:l/2,placeholder:`${e.$t("main_ui_output")}:SELECT * FROM T WHERE id=1 AND name='zhangshan'`},null,8,["model-value","height","placeholder"])]),_:2},1024)]),_:1})}}});export{V as default};
