import{u as v,i as T}from"./action-068fc8bd.js";import{d as k,y as C,z as I,D as b,c as w,w as a,r as i,f as A,v as e,j as n,C as z,E,T as s}from"./tool-cbeb39ad.js";import{a as H}from"./index-87706fee.js";import"./modulepreload-polyfill-3cfb730f.js";const S=k({__name:"Sign",async setup(U){let p,c;const t=v(([p,c]=C(()=>T({input:z("text"),option:{private_key:"",user_id:"1234567812345678"},output:E("hex")})),p=await p,c(),p)),m=I(()=>{if(t.current.input.text.isEmpty()||t.current.option.private_key==="")return s.empty();if(t.current.input.text.isError())return t.current.input.text;try{return s.fromHex(H.sm2.doSignature(t.current.input.text.toArray(),t.current.option.private_key,{hash:!0,userId:t.current.option.user_id}))}catch(r){return s.fromError($error(r))}});return b(()=>m.value,r=>{r.isEmpty()||t.save()},{immediate:!0,deep:!0}),(r,o)=>{const _=i("TextInput"),d=i("Input"),l=i("Align"),f=i("HelpTip"),x=i("Card"),g=i("TextOutput"),y=i("HeightResize");return A(),w(y,{ignore:"",append:[".ctool-page-option"],reduce:10},{default:a(({small:h,large:V})=>[e(l,{direction:"vertical"},{default:a(()=>[e(_,{modelValue:n(t).current.input,"onUpdate:modelValue":o[0]||(o[0]=u=>n(t).current.input=u),height:h,upload:"file"},null,8,["modelValue","height"]),e(x,{title:r.$t("main_ui_config"),class:"ctool-page-option"},{extra:a(()=>[e(l,null,{default:a(()=>[e(f,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})]),default:a(()=>[e(l,{horizontal:"center"},{default:a(()=>[e(d,{modelValue:n(t).current.option.private_key,"onUpdate:modelValue":o[1]||(o[1]=u=>n(t).current.option.private_key=u),label:r.$t("sm2_private_key")},null,8,["modelValue","label"]),e(d,{modelValue:n(t).current.option.user_id,"onUpdate:modelValue":o[2]||(o[2]=u=>n(t).current.option.user_id=u),label:r.$t("sm2_userId")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["title"]),e(g,{modelValue:n(t).current.output,"onUpdate:modelValue":o[3]||(o[3]=u=>n(t).current.output=u),allow:["base64","hex"],content:n(m),height:V},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1},8,["append"])}}});export{S as default};
