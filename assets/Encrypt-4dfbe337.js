import{u as T,i as w}from"./action-1cc9b3bd.js";import{c as z,a as A,T as c}from"./index-07ad6e4c.js";import{s as d}from"./index-636623a5.js";import{A as E,bi as H,k as K,m as I,bj as i,aF as u,as as U,x as o,a$ as n}from"./history-91cfa0f9.js";import"./_commonjsHelpers-87174ba5.js";import"./index-cc134824.js";const F=E({__name:"Encrypt",async setup($){let l,s;const e=T(([l,s]=H(()=>w({input:z("text"),option:{public_key:"",private_key:"",cipher_mode:1},output:A("hex")})),l=await l,s(),l)),_=K(()=>{if(e.current.input.text.isEmpty()||e.current.option.public_key==="")return c.empty();if(e.current.input.text.isError())return e.current.input.text;try{if(!e.current.input.text.isText())throw new Error("input content must text / text file");return c.fromHex(d.sm2.doEncrypt(e.current.input.text.toString(),e.current.option.public_key,e.current.option.cipher_mode))}catch(p){return c.fromError($error(p))}}),y=()=>{let p=d.sm2.generateKeyPairHex();e.current.option.public_key=p.publicKey,e.current.option.private_key=p.privateKey};return(p,t)=>{const x=u("TextInput"),m=u("Input"),a=u("Align"),f=u("Select"),g=u("Button"),k=u("HelpTip"),V=u("Card"),b=u("TextOutput"),h=u("HeightResize");return U(),I(h,{ignore:"",append:[".ctool-page-option"],reduce:10},{default:i(({small:v,large:C})=>[o(a,{direction:"vertical"},{default:i(()=>[o(x,{modelValue:n(e).current.input,"onUpdate:modelValue":t[0]||(t[0]=r=>n(e).current.input=r),height:v,upload:"file"},null,8,["modelValue","height"]),o(V,{title:p.$t("main_ui_config"),class:"ctool-page-option"},{extra:i(()=>[o(a,null,{default:i(()=>[o(f,{size:"small",options:[{value:1,label:"C1-C3-C2"},{value:0,label:"C1-C2-C3"}],modelValue:n(e).current.option.cipher_mode,"onUpdate:modelValue":t[3]||(t[3]=r=>n(e).current.option.cipher_mode=r)},null,8,["modelValue"]),o(g,{type:"primary",size:"small",text:p.$t("sm2_generate_keypair"),onClick:y},null,8,["text"]),o(k,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})]),default:i(()=>[o(a,{horizontal:"center"},{default:i(()=>[o(m,{modelValue:n(e).current.option.public_key,"onUpdate:modelValue":t[1]||(t[1]=r=>n(e).current.option.public_key=r),placeholder:"Public Key"},null,8,["modelValue"]),o(m,{modelValue:n(e).current.option.private_key,"onUpdate:modelValue":t[2]||(t[2]=r=>n(e).current.option.private_key=r),placeholder:"Private Key"},null,8,["modelValue"])]),_:1})]),_:1},8,["title"]),o(b,{modelValue:n(e).current.output,"onUpdate:modelValue":t[4]||(t[4]=r=>n(e).current.output=r),allow:["base64","hex"],content:_.value,height:C,onSuccess:t[5]||(t[5]=r=>n(e).save())},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1},8,["append"])}}});export{F as default};
