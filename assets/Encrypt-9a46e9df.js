import{u as E,i as k}from"./action-6d7b183c.js";import{c as A,a as S,T as p}from"./index-63ad488e.js";import{j as d}from"./jsrsasign-a00b5ff7.js";import{D as C,bj as N,l as R,bf as U,n as D,bk as i,aG as o,aH as K,at as _,y as u,bm as O,p as z,b0 as r}from"./history-22e01718.js";import"./_commonjsHelpers-87174ba5.js";import"./index-b1ff2442.js";import"./shim-03580cdb.js";const L=C({__name:"Encrypt",async setup(H){let l,s;const x=[{value:"RSA",label:"PKCS1"},{value:"RSAOAEP",label:"PKCS1_OAEP"}],e=E(([l,s]=N(()=>k({input:A("text"),algName:"RSA",key:"",output:S("base64")})),l=await l,s(),l)),c=R(()=>{if(e.current.input.text.isEmpty()||e.current.key.trim()==="")return p.empty();if(e.current.input.text.isError())return e.current.input.text;try{if(!e.current.input.text.isText())throw new Error("input content must text / text file");return p.fromHex(d.KJUR.crypto.Cipher.encrypt(e.current.input.text.toString(),d.KEYUTIL.getKey(e.current.key.trim()),e.current.algName))}catch(a){return p.fromError($error(a))}});return U(()=>c.value,a=>{a.isEmpty()||e.save()},{immediate:!0,deep:!0}),(a,t)=>{const g=o("Textarea"),h=o("TextInput"),f=o("TextOutput"),y=o("Select"),V=o("Display"),v=o("Align"),T=o("HeightResize"),b=K("row");return _(),D(T,{ignore:"",reduce:5},{default:i(({small:m,large:w})=>[u(v,{direction:"vertical"},{default:i(()=>[O((_(),z("div",null,[u(g,{height:m,modelValue:r(e).current.key,"onUpdate:modelValue":t[0]||(t[0]=n=>r(e).current.key=n),placeholder:a.$t("rsa_public")},null,8,["height","modelValue","placeholder"]),u(h,{modelValue:r(e).current.input,"onUpdate:modelValue":t[1]||(t[1]=n=>r(e).current.input=n),placeholder:a.$t("rsa_encrypt_input"),height:m},null,8,["modelValue","placeholder","height"])])),[[b,"1-1"]]),u(V,{position:"top-right",toggle:""},{extra:i(()=>[u(y,{size:"small",modelValue:r(e).current.algName,"onUpdate:modelValue":t[3]||(t[3]=n=>r(e).current.algName=n),options:x},null,8,["modelValue"])]),default:i(()=>[u(f,{modelValue:r(e).current.output,"onUpdate:modelValue":t[2]||(t[2]=n=>r(e).current.output=n),allow:["base64","hex"],content:c.value,height:w},null,8,["modelValue","content","height"])]),_:2},1024)]),_:2},1024)]),_:1})}}});export{L as default};
