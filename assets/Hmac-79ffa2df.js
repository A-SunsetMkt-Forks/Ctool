import{u as T,i as k}from"./action-72e8fcf1.js";import{d as z,y as D,z as S,A as M,k as H,v as a,w as m,r as d,B as U,f as w,j as l,F as j,q as I,c as L,C as v,T as F}from"./tool-f12e4b81.js";import{C as s}from"./index-29e5ad3b.js";import{s as R}from"./index-ae65b504.js";import"./modulepreload-polyfill-3cfb730f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-57af8234.js";import"./string_decoder-5eb15080.js";import"./index-af4bedce.js";const y=["md5","sha1","sha256","sha512","sm3"],V={md5:(o,t)=>s.HmacMD5(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha1:(o,t)=>s.HmacSHA1(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha256:(o,t)=>s.HmacSHA256(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha512:(o,t)=>s.HmacSHA512(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sm3:(o,t)=>{const h=(u,r)=>u.length>=r?u:new Array(r-u.length+1).join("0")+u;let e=o.toHexString();const _=[];let f=e.length;f%2!==0&&(e=h(e,f+1)),f=e.length;for(let u=0;u<f;u+=2)_.push(parseInt(e.substr(u,2),16));return R.sm3(_,{key:t.toHexString()})}},A=(o,t,h)=>{if(!Object.keys(V).includes(o))throw new Error(`hmac method 不存在: ${o}`);return V[o](t,h)},X=z({__name:"Hmac",async setup(o){let t,h;const e=T(([t,h]=D(()=>k({input:v(),secret:v("text"),is_uppercase:!1,multiple:!1})),t=await t,h(),t)),_=S(()=>["text"].includes(e.current.input.type)),f=S(()=>{let r={md5:"",sha1:"",sha256:"",sha512:"",sm3:""};if(e.current.input.text.isEmpty()||e.current.secret.text.isEmpty())return r;let n=!1;for(let i of y)try{if(e.current.input.text.isError())throw new Error(`input:${e.current.input.text.toString()}`);if(e.current.secret.text.isError())throw new Error(`secret:${e.current.secret.text.toString()}`);const c=u(i,e.current.input.text,e.current.secret.text,_.value&&e.current.multiple);r[i]=e.current.is_uppercase?c.toUpperCase():c.toLowerCase()}catch(c){n=!0,r[i]=$error(c)}return n||e.save(),r}),u=(r,n,i,c)=>c?n.toString().split(`
`).map(x=>A(r,F.fromString(x,n.encoding()),i)).join(`
`):A(r,n,i);return(r,n)=>{const i=d("TextInput"),c=d("HeightResize"),x=d("Bool"),b=d("Tooltip"),B=d("Align"),C=d("Display"),$=d("Textarea"),E=U("row");return M((w(),H("div",null,[a(B,{direction:"vertical"},{default:m(()=>[a(i,{class:"ctool-page-option",modelValue:l(e).current.secret,"onUpdate:modelValue":n[0]||(n[0]=p=>l(e).current.secret=p),"use-input":r.$t("hmac_secret"),allow:["text","hex","base64"]},null,8,["modelValue","use-input"]),a(C,null,{extra:m(()=>[a(B,null,{default:m(()=>[a(x,{size:"small",modelValue:l(e).current.is_uppercase,"onUpdate:modelValue":n[2]||(n[2]=p=>l(e).current.is_uppercase=p),border:"",label:r.$t("hmac_uppercase")},null,8,["modelValue","label"]),a(b,{content:r.$t("hmac_multiple_tooltip")},{default:m(()=>[a(x,{disabled:!l(_),size:"small",modelValue:l(e).current.multiple,"onUpdate:modelValue":n[3]||(n[3]=p=>l(e).current.multiple=p),border:"",label:r.$t("hmac_multiple")},null,8,["disabled","modelValue","label"])]),_:1},8,["content"])]),_:1})]),default:m(()=>[a(c,{append:[".ctool-page-option"],reduce:5},{default:m(({height:p})=>[a(i,{modelValue:l(e).current.input,"onUpdate:modelValue":n[1]||(n[1]=g=>l(e).current.input=g),height:p,upload:"file",encoding:""},null,8,["modelValue","height"])]),_:1},8,["append"])]),_:1})]),_:1}),a(c,null,{default:m(({height:p})=>[a(B,{direction:"vertical"},{default:m(()=>[(w(!0),H(j,null,I(l(y),g=>(w(),L($,{"model-value":l(f)[g],height:(p-20)/5,placeholder:`HMAC-${g}`,copy:`HMAC-${g}`},null,8,["model-value","height","placeholder","copy"]))),256))]),_:2},1024)]),_:1})])),[[E,"10-14"]])}}});export{X as default};
