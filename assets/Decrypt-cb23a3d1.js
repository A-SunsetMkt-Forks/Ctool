import{u as w,i as E}from"./action-068fc8bd.js";import{d as S,y as C,z as D,D as N,c as R,w as i,r as o,B as U,f as d,v as u,A as z,k as K,j as t,C as O,E as b,T as p}from"./tool-cbeb39ad.js";import{j as _}from"./jsrsasign-9f66ba05.js";import"./modulepreload-polyfill-3cfb730f.js";const $=S({__name:"Decrypt",async setup(B){let l,s;const g=[{value:"RSA",label:"PKCS1"},{value:"RSAOAEP",label:"PKCS1_OAEP"}],e=w(([l,s]=C(()=>E({input:O("base64"),algName:"RSA",key:"",output:b("text")})),l=await l,s(),l)),c=D(()=>{if(e.current.input.text.isEmpty()||e.current.key.trim()==="")return p.empty();if(e.current.input.text.isError())return e.current.input.text;try{return p.fromString(_.KJUR.crypto.Cipher.decrypt(e.current.input.text.toHexString(),_.KEYUTIL.getKey(e.current.key.trim()),e.current.algName))}catch(a){return p.fromError($error(a))}});return N(()=>c.value,a=>{a.isEmpty()||e.save()},{immediate:!0,deep:!0}),(a,r)=>{const h=o("Textarea"),x=o("TextInput"),y=o("TextOutput"),f=o("Select"),v=o("Display"),V=o("Align"),T=o("HeightResize"),A=U("row");return d(),R(T,{ignore:"",reduce:5},{default:i(({small:m,large:k})=>[u(V,{direction:"vertical"},{default:i(()=>[z((d(),K("div",null,[u(h,{height:m,modelValue:t(e).current.key,"onUpdate:modelValue":r[0]||(r[0]=n=>t(e).current.key=n),placeholder:a.$t("rsa_private")},null,8,["height","modelValue","placeholder"]),u(x,{modelValue:t(e).current.input,"onUpdate:modelValue":r[1]||(r[1]=n=>t(e).current.input=n),placeholder:a.$t("rsa_decrypt_input"),allow:["base64","hex"],height:m},null,8,["modelValue","placeholder","height"])])),[[A,"1-1"]]),u(v,{position:"top-right",toggle:""},{extra:i(()=>[u(f,{size:"small",modelValue:t(e).current.algName,"onUpdate:modelValue":r[3]||(r[3]=n=>t(e).current.algName=n),options:g},null,8,["modelValue"])]),default:i(()=>[u(y,{modelValue:t(e).current.output,"onUpdate:modelValue":r[2]||(r[2]=n=>t(e).current.output=n),content:t(c),height:k},null,8,["modelValue","content","height"])]),_:2},1024)]),_:2},1024)]),_:1})}}});export{$ as default};
