import{u as T,i as A}from"./action-c0645e21.js";import{c as $,a as z,T as c}from"./index-5818e2f6.js";import{s as d}from"./index-636623a5.js";import{A as H,bi as U,k as E,m as I,bj as p,aF as u,as as w,x as n,a$ as r}from"./history-cad96479.js";import"./_commonjsHelpers-87174ba5.js";import"./index-69be48ff.js";const G=H({__name:"Encrypt",async setup(B){let i,s;const e=T(([i,s]=U(()=>A({input:$("text"),option:{public_key:"",private_key:"",cipher_mode:1},output:z("hex")})),i=await i,s(),i)),_=E(()=>{if(e.current.input.text.isEmpty()||e.current.option.public_key==="")return c.empty();if(e.current.input.text.isError())return e.current.input.text;try{let o=d.sm2.doEncrypt(e.current.input.text.toUint8Array(),e.current.option.public_key,e.current.option.cipher_mode);return c.fromHex(o)}catch(o){return c.fromError($error(o))}}),y=()=>{let o=d.sm2.generateKeyPairHex();e.current.option.public_key=o.publicKey,e.current.option.private_key=o.privateKey};return(o,t)=>{const x=u("TextInput"),m=u("Input"),a=u("Align"),f=u("Select"),k=u("Button"),b=u("HelpTip"),g=u("Card"),V=u("TextOutput"),v=u("HeightResize");return w(),I(v,{ignore:"",append:[".ctool-page-option"],reduce:10},{default:p(({small:C,large:h})=>[n(a,{direction:"vertical"},{default:p(()=>[n(x,{modelValue:r(e).current.input,"onUpdate:modelValue":t[0]||(t[0]=l=>r(e).current.input=l),height:C,upload:"file"},null,8,["modelValue","height"]),n(g,{title:o.$t("main_ui_config"),class:"ctool-page-option"},{extra:p(()=>[n(a,null,{default:p(()=>[n(f,{size:"small",options:[{value:1,label:"C1-C3-C2"},{value:0,label:"C1-C2-C3"}],modelValue:r(e).current.option.cipher_mode,"onUpdate:modelValue":t[3]||(t[3]=l=>r(e).current.option.cipher_mode=l)},null,8,["modelValue"]),n(k,{type:"primary",size:"small",text:o.$t("sm2_generate_keypair"),onClick:y},null,8,["text"]),n(b,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})]),default:p(()=>[n(a,{horizontal:"center"},{default:p(()=>[n(m,{modelValue:r(e).current.option.public_key,"onUpdate:modelValue":t[1]||(t[1]=l=>r(e).current.option.public_key=l),label:o.$t("sm2_public_key")},null,8,["modelValue","label"]),n(m,{modelValue:r(e).current.option.private_key,"onUpdate:modelValue":t[2]||(t[2]=l=>r(e).current.option.private_key=l),label:o.$t("sm2_private_key")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["title"]),n(V,{modelValue:r(e).current.output,"onUpdate:modelValue":t[4]||(t[4]=l=>r(e).current.output=l),allow:["base64","hex"],content:_.value,height:h,onSuccess:t[5]||(t[5]=l=>r(e).save())},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1},8,["append"])}}});export{G as default};
