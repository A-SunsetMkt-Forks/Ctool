import{u as O,i as R}from"./action-72e8fcf1.js";import{d as h,ae as u,y as A,z as s,D as N,I as U,H as L,c as z,w as m,r as d,B as q,f as v,v as a,j as n,m as T,A as F,k as G,s as y,l as E,n as J,aY as g}from"./tool-f12e4b81.js";import{u as K,t as P,z as Q,e as W}from"./en_US-de05569b.js";import"./modulepreload-polyfill-3cfb730f.js";const ie=h({__name:"Timestamp",async setup(X){let c,x;u.extend(K),u.extend(P);const t=O(([c,x]=A(()=>R({input:"",timezone:u.tz.guess(),unix_type:2},{paste:e=>new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(e)||new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(e)||new RegExp(/^-?\d{5,}$/).test(e)})),c=await c,x(),c)),o=s(()=>(t.current.input||"").trim()),p=s(()=>o.value===""?!1:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(o.value)?0:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(o.value)?1:new RegExp(/^-?\d+$/).test(o.value)?2:!1),w=s(()=>new RegExp(/^-?\d{1,12}$/).test(o.value)?3:4),r=s(()=>{try{if(o.value==="")return"";if(p.value===!1)throw new Error($t("time_error_format"));let e;if(p.value===0?e=u.tz(o.value,t.current.timezone):p.value===1?e=u.tz(o.value,t.current.timezone):(t.current.unix_type===2?w.value:t.current.unix_type)===3?e=u(parseInt(o.value)*1e3).tz(t.current.timezone):e=u(parseInt(o.value)).tz(t.current.timezone),!e.isValid())throw new Error($t("time_error_format"));return e}catch(e){return $error(e)}}),f=s(()=>g.isDayjs(r.value)),k=s(()=>g.isDayjs(r.value)?p.value!==2?r.value.unix().toString():r.value.format("YYYY-MM-DD HH:mm:ss"):r.value),D=s(()=>g.isDayjs(r.value)?p.value!==2?r.value.valueOf().toString():r.value.format("YYYY-MM-DD HH:mm:ss.SSS"):r.value);N(()=>({data:t.current,is_valid:f.value}),({is_valid:e})=>{e&&t.save()},{immediate:!0,deep:!0});const Y=s(()=>Object.entries($t("main_locale")==="zh_CN"?Q:W).map(([e,l])=>({value:e,label:`${l}`})));console.log(Y.value);let b=U(u().valueOf());const H=setInterval(()=>{b.value=u().valueOf()},100);L(()=>{clearInterval(H)});const I=s(()=>{const e=u(b.value).tz(t.current.timezone);return[{format:$t("time_normal_second"),value:e.format("YYYY-MM-DD HH:mm:ss")},{format:$t("time_unix_second"),value:e.unix().toString()},{format:$t("time_normal_millisecond"),value:e.format("YYYY-MM-DD HH:mm:ss.SSS")},{format:$t("time_unix_millisecond"),value:e.valueOf().toString()}]});return(e,l)=>{const V=d("Select"),_=d("Input"),C=d("Button"),S=d("Align"),$=d("Display"),M=d("Link"),j=d("Table"),B=q("row");return v(),z(S,{direction:"vertical"},{default:m(()=>[a(V,{size:"large",width:"100%",center:!1,label:e.$t("time_timezone"),modelValue:n(t).current.timezone,"onUpdate:modelValue":l[0]||(l[0]=i=>n(t).current.timezone=i),options:n(Y),onChange:l[1]||(l[1]=i=>n(t).current.timezone=i)},null,8,["label","modelValue","options"]),a($,{position:"right-center"},{extra:m(()=>[a(S,null,{default:m(()=>[n(p)===2?(v(),z(V,{key:0,modelValue:n(t).current.unix_type,"onUpdate:modelValue":l[3]||(l[3]=i=>n(t).current.unix_type=i),size:"small",options:[{value:2,label:`${e.$t("time_unix_auto")}:${n(w)===3?e.$t("time_second"):e.$t("time_millisecond")}`},{value:3,label:e.$t("time_unix_second")},{value:4,label:e.$t("time_unix_millisecond")}]},null,8,["modelValue","options"])):T("",!0),n(t).current.input!==""?(v(),z(C,{key:1,text:e.$t("main_ui_clear"),onClick:l[4]||(l[4]=i=>n(t).current.input=""),size:"small"},null,8,["text"])):T("",!0)]),_:1})]),default:m(()=>[a(_,{size:"large",modelValue:n(t).current.input,"onUpdate:modelValue":l[2]||(l[2]=i=>n(t).current.input=i),label:e.$t("main_ui_input"),placeholder:e.$t("time_timestamp_input_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),F((v(),G("div",null,[a($,{position:"right-center",text:n(f)?e.$t("main_ui_copy"):"",onClick:l[5]||(l[5]=()=>e.$copy(n(k)))},{default:m(()=>[a(_,{size:"large","model-value":n(k),label:e.$t("time_second")},null,8,["model-value","label"])]),_:1},8,["text"]),a($,{position:"right-center",text:n(f)?e.$t("main_ui_copy"):"",onClick:l[6]||(l[6]=()=>e.$copy(n(D)))},{default:m(()=>[a(_,{size:"large","model-value":n(D),label:e.$t("time_millisecond")},null,8,["model-value","label"])]),_:1},8,["text"])])),[[B,"1-1"]]),y("div",null,[a(j,{columns:[{title:e.$t("time_format"),key:"format"},{title:e.$t("time_value"),key:"value"}],lists:n(I),"action-width":100,border:""},{column:m(({row:i})=>[y("td",null,E(i.format),1),y("td",null,[a(M,{onClick:Z=>e.$copy(i.value)},{default:m(()=>[J(E(i.value),1)]),_:2},1032,["onClick"])])]),default:m(({row:i})=>[a(C,{text:e.$t("main_ui_load"),onClick:()=>n(t).current.input=`${i.value}`,size:"small"},null,8,["text","onClick"])]),_:1},8,["columns","lists"])])]),_:1})}}});export{ie as default};
